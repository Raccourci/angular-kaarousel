"use strict";angular.module("angular-kaarousel",["ngTouch"]).directive("kaarousel",["$interval","$window","$timeout",function(e,t,n){return{restrict:"EA",templateUrl:"src/angular-kaarousel.html",transclude:!0,scope:{displayed:"=",perSlide:"=",autoplay:"=",pauseOnHover:"=",centerActive:"=",timeInterval:"=",updateRate:"=",stopAfterAction:"=",hideNav:"=",hidePager:"=",navOnHover:"=",pagerOnHover:"=",swipable:"=kaaSwipable",sync:"=",rtl:"=",data:"=",animation:"@"},controller:["$scope",function(t){var r,i=this;t.slides=[],t.elements=[],t.sizes=[],t.currentIndex=0,t.swipeThreshold=50,t.swipeStageWidth=200,t.shouldAnim=!1,t.imageCollection=[],t.loadedImage=0,t.userAction=!1,t.margin=0,t.sliderMargin={"margin-left":"0px"},t.defaults={displayed:3,perSlide:1,autoplay:!0,pauseOnHover:!0,centerActive:!1,timeInterval:3e3,stopAfterAction:!1,hideNav:!1,hidePager:!1,navOnHover:!1,pagerOnHover:!1,swipable:!0,sync:!1,rtl:!1,animation:"slide"},i.getConf=function(){r={displayed:i.computeDisplayed(),perSlide:i.computePerSlides(),autoplay:t.autoplay,pauseOnHover:t.pauseOnHover,centerActive:t.centerActive,timeInterval:t.timeInterval,stopAfterAction:t.stopAfterAction,hideNav:t.hideNav,hidePager:t.hidePager,navOnHover:t.navOnHover,pagerOnHover:t.pagerOnHover,swipable:t.swipable,sync:t.sync,rtl:t.rtl,animation:t.animation};for(var e in r)void 0===r[e]&&delete r[e];return r=t.conf=angular.extend(t.defaults,r)},i.computeDisplayed=function(){var e=Math.abs(Math.ceil(t.displayed))||t.defaults.displayed;return e>t.slides.length?t.slides.length:e},i.computePerSlides=function(){var e=Math.abs(Math.ceil(t.perSlide))||t.defaults.perSlide;return t.rtl?-e:e},r=i.getConf(),i.addSlide=function(e,n){t.slides.push(e),t.elements.push(n),t.sizes.push({width:angular.element(n).outerWidth(),height:angular.element(n).outerHeight()}),r.rtl&&(t.currentIndex=t.elements.length-1)},i.computeIndex=function(e){var n=t.slides.length;return e>=n&&(e=0),0>e&&(e=n-1),e},t.goPrev=function(e,n){var a=t.currentIndex-(n||parseInt(r.perSlide,10));return e&&r.stopAfterAction&&(t.userAction=!0),i.setInterval(i.shouldStop()),i.goTo(i.computeIndex(a))},t.goNext=function(e,n){var a=t.currentIndex+(n||parseInt(r.perSlide,10));return e&&r.stopAfterAction&&(t.userAction=!0),i.setInterval(i.shouldStop()),i.goTo(i.computeIndex(a))},i.shouldStop=function(){return r.autoplay?t.userAction&&r.stopAfterAction||t.pausedByUser?!0:!1:!0},i.goTo=function(e){var a=t.slides.length-r.displayed;return n(function(){t.currentIndex=e,t.margin=i.getMargin(e,a),t.sliderMargin["margin-left"]=-t.margin+"px"}),e},i.move=function(e){n(function(){var n=t.elements.length-r.displayed,a=i.getMargin(t.currentIndex,n)+e;t.sliderMargin["margin-left"]=-a+"px"})},i.getMargin=function(e,n){var a,o=t.slides.length,s=i.getWatchUntil(e),l=0;if(r.rtl){for(var u=0;o>u;u++)l+=t.sizes[u].width;for(a=o;a>0;a--)o-s>o-a-2&&(l-=t.sizes[a-1].width)}else for(a=0;o>a;a++)s>a&&n>a&&(l+=t.sizes[a].width);return l},i.getWatchUntil=function(e){return r.centerActive&&1&r.displayed&&(e-=Math.floor(r.displayed/2)),e},i.setInterval=function(n){e.cancel(t.interval),t.playing=!1,n||r.sync||0===r.sync||(t.interval=e(function(){t.playing=!0,t.shouldAnim=!0,t.goNext()},r.timeInterval))},i.updateSizes=function(){for(var e=0;e<t.elements.length;e++)t.sizes[e]={width:angular.element(t.elements[e]).outerWidth(),height:angular.element(t.elements[e]).outerHeight()}},t.getStyles=function(){var e={};return"fade"!==t.animation?e=t.sliderMargin:t.isReady&&(e={height:t.sizes[t.currentIndex].height}),e},i.getCurrentIndex=function(){return t.currentIndex},i.lastOfItems=function(){t.isReady=!0,i.goTo(i.getCurrentIndex()),r.autoplay&&!t.playing&&i.setInterval()},this.updateKaarousel=function(e){i.getConf(),e&&i.setInterval(i.shouldStop()),i.updateSizes(),i.goTo(t.currentIndex)},this.getNbElements=function(){return t.slides.length},this.addImage=function(e){t.imageCollection.push(e),t.loadedImage++,i.updateSizes()},t.pause=function(){t.pausedByUser=!0,i.setInterval(!0)},t.resume=function(){t.pausedByUser=!1,i.setInterval(i.shouldStop())},t.mouseEnterCallback=function(){r.pauseOnHover&&t.pause(),r.navOnHover&&(t.hideNav=!1),r.pagerOnHover&&(t.hidePager=!1)},t.mouseLeaveCallback=function(){!r.stopAfterHover&&r.pauseOnHover&&t.resume(),r.navOnHover&&(t.hideNav=!0),r.pagerOnHover&&(t.hidePager=!0)}}],link:function(e,r,i,a){var o,s,l="[autoplay, timeInterval, sync, displayed, perSlide, centerActive, stopAfterAction, pauseOnHover, rtl]";angular.element(r).addClass("kaarousel"),console.log(e.$id),angular.element(t).resize(function(){n.cancel(o),o=n(function(){a.updateKaarousel(!0)},e.updateRate||500)}),e.$watchCollection(l,function(t,r){n.cancel(s),s=n(function(){for(var e,n=0;3>n;n++)if(t[n]!==r[n]){e=!0;break}a.updateKaarousel(e)},e.updateRate)}),e.$watch("sync",function(){isNaN(e.sync)||(e.shouldAnim=!0,e.pausedByUser||a.goTo(e.sync))})}}}]).directive("kaarouselWrapper",["$swipe","$timeout",function(e,t){return{restrict:"EA",require:"^kaarousel",link:function(n,r,i,a){var o,s,l=function(){return o&&s&&Math.abs(o.x-s.x)>n.swipeThreshold},u=function(){return Math.floor(Math.abs(o.x-s.x)/n.swipeStageWidth)+1};n.wrapperElement=r,n.swipeNext=function(){l()&&n.goNext(!0,u())},n.swipePrev=function(){l()&&n.goPrev(!0,u())},n.addSwipeOffset=function(){var e=o.x-s.x;a.move(e)},n.resetSwipe=function(){a.goTo(n.currentIndex)},n.swipeHandler=e.bind(r,{start:function(e){n.conf.swipable&&t(function(){o=e,s=null,n.shouldAnim=!1,n.dragging=!0})},move:function(e){n.conf.swipable&&t(function(){s=e,n.addSwipeOffset(),n.shouldAnim=!1,n.dragging=!0})},end:function(e){n.conf.swipable&&t(function(){s=e;var t=o.x-s.x;t?t>0?n.swipeNext():n.swipePrev():n.resetSwipe(),n.shouldAnim=!0,n.dragging=!1})},cancel:function(){n.conf.swipable&&n.resetSwipe()}})}}}]).directive("kaarouselSlider",["$compile",function(e){return{restrict:"EA",require:"^kaarousel",link:function(t,n){var r='<kaarousel-dummy class="dummy" ng-style="getStyles()"></kaarousel-dummy>';t.sliderElement=n,angular.element(n).addClass(t.conf.animation+"-animation"),e(r)(t,function(e,t){angular.element(t.sliderElement).prepend(e)})}}}]).directive("kaarouselSlide",function(){return{restrict:"EA",require:"^kaarousel",link:function(e,t,n,r){r.addSlide(e.slide,t),angular.element(t).addClass("kaarousel-slide"),e.$last&&r.lastOfItems(),e.itemStyles=function(){return{width:100/r.getConf().displayed+"%"}},e.checkIndex=function(e){return r.getCurrentIndex()===e},e.isVisible=function(e){var t=r.getCurrentIndex(),n=r.getNbElements(),i=r.getConf(),a=i.displayed;return i.centerActive?e>=t-Math.floor(a/2)&&e<=t+Math.floor(a/2)||a>t+1&&a>e||t>n-a-1&&e>n-a-1:e>=t&&t+a>e||e>n-a-1&&t>n-a-1},angular.element(t).find("img").on("load",function(){r.addImage(this)})}}}).directive("kaarouselImage",function(){return{require:"^kaarousel",restrict:"EAC",link:function(){}}}).directive("kaarouselPager",function(){return{restrict:"EA",require:"^kaarousel",link:function(e,t,n,r){e.goTo=function(t){e.stopAfterAction&&(e.userAction=!0),r.setInterval(r.shouldStop()),r.goTo(t)}}}});
!function(a){try{a=angular.module("angularKaarousel")}catch(e){a=angular.module("angularKaarousel",[])}a.run(["$templateCache",function(a){a.put("angular-kaarousel.html",'<div class="kaarousel-actions-wrapper" ng-mouseenter="mouseEnterCallback()" ng-mouseleave="mouseLeaveCallback()"><kaarousel-wrapper class="kaarousel-wrapper" ng-class="{shouldAnim: shouldAnim, dragging: dragging}"><kaarousel-slider ng-transclude="" class="kaarousel-slider"></kaarousel-slider></kaarousel-wrapper><kaarousel-nav ng-class="{hidden: hideNav}"><kaarousel-prev ng-click="goPrev()" class="kaarousel-prev kaarousel-nav">PREV</kaarousel-prev><kaarousel-next ng-click="goNext()" class="kaarousel-next kaarousel-nav">NEXT</kaarousel-next></kaarousel-nav><kaarousel-pager class="kaarousel-pager" ng-class="{hidden: hidePager}"><ul><li ng-repeat="i in slides track by $index" ng-click="goTo($index)" ng-class="{selected: $index === currentIndex}">{{$index}}</li></ul></kaarousel-pager></div>')}])}();